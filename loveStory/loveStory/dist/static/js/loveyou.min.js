define("common",[],function(){return{navUserAgent:function(){var i={versions:function(){var i=navigator.userAgent;navigator.appVersion;return{trident:i.indexOf("Trident")>-1,presto:i.indexOf("Presto")>-1,webKit:i.indexOf("AppleWebKit")>-1,gecko:i.indexOf("Gecko")>-1&&i.indexOf("KHTML")==-1,mobile:!!i.match(/AppleWebKit.*Mobile.*/),ios:!!i.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:i.indexOf("Android")>-1||i.indexOf("Linux")>-1,iPhone:i.indexOf("iPhone")>-1,iPad:i.indexOf("iPad")>-1,webApp:i.indexOf("Safari")==-1,weibo:i.indexOf("Weibo")>-1}}(),isPcOrMobile:function(){return(i.versions.mobile||i.versions.ios||i.versions.android||i.versions.iPhone)&&!i.versions.iPad?"mobile":"pc"},isTrueMobile:function(){return!!(i.versions.mobile||i.versions.ios||i.versions.android||i.versions.iPhone||i.versions.iPad)},isIosDevice:function(){return!!(i.versions.ios||i.versions.iPhone||i.versions.iPad)},isInWeibo:function(){return!!i.versions.weibo},language:(navigator.browserLanguage||navigator.language).toLowerCase()};return i}}}),define("loveStory",["./common"],function(i){var e=null,t=null,n=null,o=null,a=null,s=null,r=null,d=document.getElementById("clickAudio"),l=!1,c=document.getElementById("weddingAudio"),m=!1,g=document.getElementById("fireworksAudio"),u=!1;return{init:function(){var e=this;e.initPage(),e.initCurtain(),e.initEvent(),i.navUserAgent().isTrueMobile()&&"mobile"==i.navUserAgent().isPcOrMobile()&&$("#mask").addClass("flexcontainer")},initPage:function(){var i=this;$("#pageWrapper").height($(window).height()),$(".page").height($(window).height()),Zepto(function(o){o(".page-wrapper").onePageScroll({sectionContainer:"section",easing:"ease-out",animationTime:1e3,pagination:!0,updateURL:!1,beforeMove:function(i){},afterMove:function(s){1==s&&(u=!1,o(".fireworks-audio").click(),i.initCurtain()),2==s?(o("canvas").remove(),i.initLoveStory(),l=!1,o(".click-audio").click(),m=!0,o(".wedding-audio").click(),u=!0,o(".fireworks-audio").click(),o(".left-curtain").removeClass("open-curtain"),o(".right-curtain").removeClass("open-curtain"),o(".page1-content").removeClass("show")):(o("#story").empty(),l=!0,o(".click-audio").click(),clearInterval(e)),3==s&&(m=!1,o(".wedding-audio").click(),clearTimeout(n),i.initPage3()),4==s?(o(".icons-list ul").empty(),o(".ul-wrapper").removeClass("slider"),o("canvas").remove(),clearInterval(t),m=!1,o(".wedding-audio").click(),u=!0,o(".fireworks-audio").click(),o(".wedding-photos li").each(function(i,e){var t=o(e).find("img"),n=t.attr("data-src");t.attr("src")||t.attr("src",n)}),o(".page4 .wedding-photos li").addClass("move"),n=setTimeout(function(){var e=o(".wedding-photos li").eq(0),t=e.find("img").attr("src"),n=e.find("img").attr("data-index");o(".wedding-photos li").removeClass("selected"),e.addClass("selected"),o(".zoom-img img").css({"-webkit-transition":"all 1s .2s ease",transition:"all 1s .2s ease"}),setTimeout(function(){o(".zoom-img").width("100%"),o(".zoom-img img").attr({src:t,"data-index":n}),o(".zoom-img a").addClass("show").css("display","inline-block"),o(".zoom-img img").addClass("show")},300),i.autoShowWeddings()},6600)):(o(".zoom-img img").removeClass("show").attr({src:"","data-index":"",style:""}),o(".zoom-img a").removeClass("show"),o(".page4 .wedding-photos li").removeClass("move")),5==s&&(i.initDownIcons(),r=new Fireworks,clearTimeout(n),clearInterval(a),m=!0,o(".wedding-audio").click(),u=!1,o(".fireworks-audio").click())},loop:!1,keyboard:!0,responsiveFallback:!1})})},initCurtain:function(){var i=Math.max($(document).height(),$(window).height());$(".left-curtain").height(i).addClass("open-curtain"),$(".right-curtain").height(i).addClass("open-curtain"),$(".page1-content").height(i),setTimeout(function(){$(".page1-content").addClass("show")},1e3),setTimeout(function(){r=new Fireworks,d.load(),c.load(),g.load(),u=!1,$(".fireworks-audio").click()},3e3)},initEvent:function(){var i=this;$(".click-audio").on("click",function(i){l?(d.pause(),l=!1):(d.play(),l=!0)}),$(".wedding-audio").on("click",function(i){m?(c.pause(),m=!1):(c.play(),m=!0)}),$(".fireworks-audio").on("click",function(i){u?(g.pause(),u=!1):(g.play(),u=!0)}),$(".wedding-photos li").on("click",function(){clearInterval(a),$(".zoom-img img").css({"-webkit-transition":"all 1s .2s ease",transition:"all 1s .2s ease"}),$(".zoom-img a").removeClass("show").hide(),$(".zoom-img img").removeClass("show").attr({src:"","data-index":"",style:""});var e=$(this).find("img").attr("data-mimg"),t=$(this).find("img").attr("data-index");$(".wedding-photos li").removeClass("selected"),$(this).addClass("selected"),$(".zoom-img").width("100%"),o=setTimeout(function(){$(".zoom-img img").attr({src:e,"data-index":t}),$(".zoom-img a").addClass("show").css("display","inline-block"),$(".zoom-img img").addClass("show")},300),i.autoShowWeddings()}),$(".zoom-img a").on("click",function(){clearTimeout(o),clearInterval(a),$(this).removeClass("show").hide(),$(".zoom-img").width("0"),$(".wedding-photos li").removeClass("selected"),$(".zoom-img img").removeClass("show").attr({src:"","data-index":"",style:""})}),this.initTouchPhotos()},initTouchPhotos:function(){var i,e,t,n=this,o=null,r=$(window).width();$(".zoom-img img").on("touchstart",function(e){e.preventDefault(),o=e.touches[0],i=o.pageX,$(".zoom-img img").css({"-webkit-transition":"none",transition:"none"})}).on("touchmove",function(n){n.preventDefault(),o=n.touches[0],e=o.pageX,t=e-i,$(".zoom-img img").css({opacity:Math.abs(r-Math.abs(t))/r})}).on("touchend",function(i){i.preventDefault(),clearTimeout(s),clearInterval(a);var e=n.getBeforeAndNext();t>100?($(".wedding-photos li").removeClass("selected"),e.beforeObj.addClass("selected"),$(".zoom-img img").attr({src:e.beforeSrc,"data-index":e.beforeIndex})):t<-100&&($(".wedding-photos li").removeClass("selected"),e.nextObj.addClass("selected"),$(".zoom-img img").attr({src:e.nextSrc,"data-index":e.nextIndex})),$(".zoom-img img").css({opacity:"1","-webkit-transition":"all 1s .2s ease",transition:"all 1s .2s ease"}),s=setTimeout(function(){$(".zoom-img img").attr({src:e.nextSrc,"data-index":e.nextIndex}),$(".zoom-img a").addClass("show").css("display","inline-block"),$(".zoom-img img").addClass("show")},800),n.autoShowWeddings()})},autoShowWeddings:function(){var i=this;$(".zoom-img img").attr("style",""),clearTimeout(s),a=setInterval(function(){e&&clearTimeout(e);var e=null;$(".zoom-img a").removeClass("show"),$(".zoom-img img").removeClass("show");var t=i.getBeforeAndNext();$(".wedding-photos li").removeClass("selected"),t.nextObj.addClass("selected"),$(".zoom-img img").css({"-webkit-transition":"all 1s .2s ease",transition:"all 1s .2s ease"}),e=setTimeout(function(){$(".zoom-img img").attr({src:t.nextSrc,"data-index":t.nextIndex}),$(".zoom-img a").addClass("show").css("display","inline-block"),$(".zoom-img img").addClass("show")},800)},3e3)},getBeforeAndNext:function(){var i=$(".zoom-img img").attr("data-index"),e="",t="",n="",o="",a=$(".left-heart li").length,s=$(".right-heart li").length,r=null,d=null,l=null,c=i.split("-")[1];return~i.indexOf("l-")?(r=$(".left-heart li").eq(c),0===$(r).index()?(d=$(".right-heart li").eq(0),l=$(".left-heart li").eq(1),e=d.find("img").attr("data-mimg"),n=l.find("img").attr("data-mimg"),t="r-0",o="l-1"):(d=$(".left-heart li").eq($(r).index()-1),e=d.find("img").attr("data-mimg"),t="l-"+($(r).index()-1),$(r).index()==a-1?(l=$(".right-heart li").eq(s-1),n=l.find("img").attr("data-mimg"),o="r-"+(s-1)):(l=$(".left-heart li").eq($(r).index()+1),n=l.find("img").attr("data-mimg"),o="l-"+($(r).index()+1)))):~i.indexOf("r-")&&(r=$(".right-heart li").eq(c),$(r).index()==$(".right-heart li").length-1?(d=$(".left-heart li").eq(a-1),l=$(".right-heart li").eq($(r).index()-1),e=d.find("img").attr("data-mimg"),n=l.find("img").attr("data-mimg"),t="l-"+(a-1),o="r-"+($(r).index()-1)):(d=$(".right-heart li").eq($(r).index()+1),e=d.find("img").attr("data-mimg"),t="r-"+($(r).index()+1),0===$(r).index()?(l=$(".left-heart li").eq(0),n=l.find("img").attr("data-mimg"),o="l-0"):(l=$(".right-heart li").eq($(r).index()-1),n=l.find("img").attr("data-mimg"),o="r-"+($(r).index()-1)))),{beforeObj:l,beforeSrc:n,beforeIndex:o,nextObj:d,nextSrc:e,nextIndex:t}},initLoveStory:function(){for(var i=["相识：2008年，谁都知道发生了很多大事，对于我家来说，也发生了不少事。当时我因为鼻炎做手术，在医院待了半个月，出院回到学校后，因为课程跟不上，就想换个班级，最后在跟两个宏志班老师协商后，我调了班级，也就是这个时候我和你成了相互不认识的同学。","相知：后来高三那年分班，我们又分到一起，还有幸做了同桌，慢慢地我们有了最纯洁的革命友谊，成了好朋友，一起奋斗在高考最后的征程线上。再后来我们跨入不同的高校，分别开始了自己的高校生活，这期间我们相互帮助，为对方的学业和感情问题出谋划策，成了无话不说的密友。","相爱：慢慢地在我们各自的生活中出现了很多不如意的问题，但我们没有放弃对方，依然相互鼓励，最终等到了彼此..."],t=1;t<=i.length;t++)$("#story").append('<p id="para'+t+'" data-id="'+t+'"></p>');var n=0,o=i[n],a=0,s="_",r="para1",d=$("#"+r).attr("data-id"),l=o.length;e=setInterval(function(){s=o.substring(0,a),a%2===0?$("#"+r).text(s+"_"):$("#"+r).text(s+""),l==s.length&&n<i.length-1&&(n++,a=0,s="_",o=i[n],r="para"+(Number(d)+1),d=$("#"+r).attr("data-id"),l=o.length),Number(d)==i.length&&l==s.length&&$("#clickAudio")[0].pause(),a++},100)},initPage3:function(){$(".ul-wrapper li").each(function(i,e){var t=$(e).find("img"),n=t.attr("data-src");t.attr("src")||$(e).find("img").attr("src",n)}),$(".ul-wrapper").addClass("slider");var i=$(".page3 li").length,e=$(".page3").width()-24;$(".page3 li").width(e),$(".page3 ul").width((e+24)*i)},initDownIcons:function(){var i=this;$(".icons-list").css({width:$(window).width(),height:$(window).height()}),i.genIcons(),t=setInterval(function(){i.genIcons()},4e3)},genIcons:function(){var i=["http://oisj33nbt.bkt.clouddn.com/xin.png","http://oisj33nbt.bkt.clouddn.com/hua.png","http://oisj33nbt.bkt.clouddn.com/xi.png","http://oisj33nbt.bkt.clouddn.com/candy-01.png","http://oisj33nbt.bkt.clouddn.com/candy-02.png","http://oisj33nbt.bkt.clouddn.com/candy-03.png"];if($(".icons-list ul li").length>=30)for(var e=0;e<20;e++)$(".icons-list ul li").eq(0).remove();for(var t=Math.floor(5*Math.random())+5,n=[],o=0;o<t;o++){var a=Math.floor(6*Math.random()),s=i[a],r=Math.floor(Math.random()*Number($(window).width())),d='<li data-id="show'+r+'" style="background: url('+s+');background-size: cover;"></li>';$(".icons-list ul").append(d),n.push(r)}setTimeout(function(){for(var i=0;i<n.length;i++)$(".icons-list li[data-id=show"+n[i]+"]").addClass("show"+n[i]),$(".icons-list li.show"+n[i]).css({left:n[i]+"px",top:$(window).height()+"px"})},10)}}});